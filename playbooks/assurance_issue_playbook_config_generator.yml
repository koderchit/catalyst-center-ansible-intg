---
- name: Generate assurance issue playbook config configuration from Cisco Catalyst Center
  hosts: localhost
  connection: local
  gather_facts: false
  vars_files:
    - "credentials.yml"
  tasks:
    # Example 1: Generate all configurations automatically
    - name: Generate complete assurance issue configuration
      cisco.dnac.assurance_issue_playbook_config_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: DEBUG
        state: gathered
        config:
          - generate_all_configurations: true
            file_path: "/tmp/active_issues_filtered.yml"

    # Example 2: Generate all components config
    - name: Generate YAML configuration for all commponents
      cisco.dnac.assurance_issue_playbook_config_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: DEBUG
        state: gathered
        config:
          - component_specific_filters:
              components_list:
                - assurance_user_defined_issue_settings

    # Example 3: Generate user-defined issue settings with filters
    - name: Generate YAML configuration for user-defined issues
      cisco.dnac.assurance_issue_playbook_config_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: true
        dnac_log_level: DEBUG
        state: gathered
        config:
          - file_path: "/tmp/user_defined_issues.yml"
            component_specific_filters:
              components_list:
                - assurance_user_defined_issue_settings
              assurance_user_defined_issue_settings:
                - name: "Custom Network Latency Alert"
                - is_enabled: true
