---
- name: Ise radius config generator playbook
  hosts: dnac_servers
  vars_files:
    - credentials.yml
  gather_facts: false
  connection: local
  tasks:
    - name: Get Authentication and Policy Server.
      cisco.dnac.brownfield_ise_radius_integration_playbook_generator:
        dnac_host: "{{ dnac_host }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_port: "{{ dnac_port }}"
        dnac_version: "{{ dnac_version }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log_level: DEBUG
        dnac_log: true
        state: gathered
        config:
          # ====================================================================================
          # SCENARIO 1: Generate All ISE and AAA Configurations without File Path specified
          # Purpose: Retrieve and generate configurations for all authentication servers
          # Use Case: Complete brownfield discovery and configuration generation
          # ====================================================================================
          # - generate_all_configurations: true

          # ====================================================================================
          # SCENARIO 1: Generate All ISE and AAA Configurations into given file path
          # Purpose: Retrieve and generate configurations for all authentication servers
          # Use Case: Complete brownfield discovery and configuration generation
          # ====================================================================================
          # - file_path: "authentication_policy_server_all_configurations.yaml"

          # ====================================================================================
          # SCENARIO 2: Filter ISE Servers Only
          # Purpose: Generate configuration for Cisco ISE servers only
          # Use Case: When you need to configure only ISE-based authentication
          # ====================================================================================
          - file_path: "authentication_policy_server_all_configurations.yaml"
            component_specific_filters:
              components_list: ["authentication_policy_server"]
              authentication_policy_server:
                server_type: ISE # Filter: ISE servers only
                server_ip_address: 10.0.0.1

          # ====================================================================================
          # SCENARIO 3: Filter AAA Servers Only
          # Purpose: Generate configuration for non-ISE AAA servers
          # Use Case: Legacy TACACS+ or RADIUS server integration
          # ====================================================================================
          # - file_path: "/tmp/aaa_configurations.yaml"
          #   component_specific_filters:
          #     components_list: ["authentication_policy_server"]
          #     authentication_policy_server:
          #       server_type: AAA  # Filter: AAA servers only

          # ====================================================================================
          # SCENARIO 4: Filter Specific Server by type and IP Address
          # Purpose: Generate configuration for a specific authentication server
          # Use Case: Targeted configuration for a single server
          # ====================================================================================
          # - file_path: "/tmp/specific_ise_server.yaml"
          #   component_specific_filters:
          #     components_list: ["authentication_policy_server"]
          #     authentication_policy_server:
          #       server_type: ISE
          #       server_ip_address: 10.0.0.10  # Filter: Specific IP

          # ====================================================================================
          # SCENARIO 5: Filter by server type and multiple IP Addresses
          # Purpose: Generate configuration for primary authentication servers
          # Use Case: When primary server configuration is needed
          # ====================================================================================
          # - file_path: "authentication_policy_server_all_configurations.yaml"
          #   component_specific_filters:
          #     components_list: ["authentication_policy_server"]
          #     authentication_policy_server:
          #       server_type: ISE  # [ISE, AAA]
          #       server_ip_address: 10.197.156.78

      register: result

      tags:
        - brownfield_templates_generator
